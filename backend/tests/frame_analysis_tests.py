import pytest
import math
from spectral.frame_analysis import *

voiced_frame = [-304, -240, -166, -77, 19, 118, 225, 333, 439, 526, 583, 613, 605, 564, 493, 388, 262, 103, -69, -229, -378, -467, -512, -529, -477, -385, -252, -85, 74, 220, 324, 379, 385, 356, 322, 270, 214, 150, 73, 6, -77, -181, -299, -452, -623, -777, -916, -995, -972, -886, -737, -552, -358, -148, 32, 176, 244, 220, 160, 51, -60, -150, -230, -277, -323, -347, -360, -383, -398, -440, -492, -541, -600, -623, -598, -519, -381, -227, -63, 104, 257, 390, 475, 497, 464, 385, 299, 219, 146, 104, 80, 63, 57, 58, 63, 53, 36, 16, -1, 14, 63, 142, 256, 385, 522, 650, 750, 823, 853, 850, 820, 737, 639, 542, 437, 348, 259, 174, 107, 61, 48, 52, 70, 104, 147, 201, 268, 339, 395, 440, 483, 519, 540, 551, 549, 512, 464, 393, 296, 200, 99, 15, -67, -128, -146, -150, -119, -76, -33, 13, 47, 85, 105, 127, 169, 205, 241, 296, 359, 420, 479, 500, 499, 469, 408, 354, 276, 217, 157, 108, 127, 123, 154, 216, 239, 288, 329, 386, 454, 520, 636, 757, 874, 990, 1110, 1208, 1220, 1212, 1192, 1076, 951, 884, 766, 677, 671, 651, 673, 708, 761, 821, 817, 852, 860, 835, 858, 866, 879, 890, 924, 955, 939, 949, 916, 838, 762, 660, 540, 388, 234, 60, -190, -431, -629, -870, -1112, -1247, -1337, -1378, -1268, -1077, -880, -616, -338, -165, -56, -5, -57, -202, -445, -706, -967, -1232, -1418, -1566, -1691, -1764, -1816, -1886, -1958, -1963, -1968, -1979, -1916, -1800, -1605, -1294, -912, -529, -174, 135, 331, 397, 353, 196, -98, -459, -788, -1093, -1313, -1390, -1368, -1262, -1083, -866, -647, -433, -231, -56, 78, 177, 282, 385, 519, 692, 823, 910, 968, 1012, 997, 926, 843, 700, 542, 401, 261, 177, 139, 151, 185, 240, 341, 440, 537, 617, 662, 680, 669, 642, 597, 566, 556, 541, 532, 524, 512, 486, 428, 332, 190, 0, -206, -406, -613, -807, -969, -1096, -1169, -1178, -1138, -1074, -962, -825, -706, -570, -451, -383, -354, -382, -445, -542, -670, -805, -935, -1043, -1135, -1216, -1269, -1289, -1293, -1307, -1312, -1301, -1280, -1226, -1135, -1006, -837, -647, -443, -234, -22, 169, 303, 369, 383, 367, 307, 218, 135, 47, -27, -55, -50, -12, 64, 156, 261, 373, 471, 572, 671, 761, 866, 965, 1058, 1175, 1294, 1402, 1498, 1552, 1558, 1517, 1429, 1302, 1141, 963, 776, 592, 443, 340, 267, 229, 228, 253, 284, 316, 363, 402, 418, 417, 388, 348, 302, 240, 167, 86, 2, -92, -199, -316, -437, -554, -691, -838, -963, -1090, -1197, -1266, -1311, -1300, -1259, -1197, -1068, -930, -802, -649, -543, -503, -502, -566, -686, -825, -965, -1093, -1175, -1207, -1179, -1083, -974, -851, -739, -685, -661, -666, -694, -689, -638, -550, -377, -164, 49, 299, 492, 618, 685, 614, 502, 366, 215, 131, 85, 100, 186, 328, 491, 637, 782, 868, 909, 912, 867, 847, 835, 857, 931, 1009, 1105, 1192, 1252, 1280, 1249, 1143, 984, 796, 593, 426, 300, 221, 210, 232, 288, 366, 431, 464, 449, 400, 312, 204, 106, 25, -28, -53, -50, -50, -62, -82, -140, -215, -322, -453, -567, -666, -728, -751, -746, -718, -681, -629, -579, -536, -507, -495, -482, -468, -444, -421, -395, -362, -322, -272, -227, -178, -127, -84, -45, -20, -2, 6, 15, 34, 62, 109, 172, 274, 408, 532, 654, 781, 864, 915, 966, 976, 983, 1009, 1027, 1079, 1140, 1204, 1279, 1320, 1333, 1315, 1272, 1204, 1148, 1114, 1061, 1070, 1127, 1174, 1246, 1306, 1329, 1331, 1310, 1247, 1173, 1104, 1037, 1007, 972, 967, 988, 968, 959, 908, 822, 730, 631, 570, 478, 452, 466, 461, 529, 584, 639, 659, 659, 640, 518, 461, 367, 244, 188, 77, 3, -61, -72, -71, -125, -136, -195, -232, -299, -358, -370, -445, -407, -401, -387, -279, -195, -74, -65, -51, -136, -360, -561, -934, -1267, -1626, -1981, -2186, -2339, -2232, -2067, -1772, -1377, -1055, -654, -413, -202, -118, -179, -234, -492, -660, -845, -1022, -1104, -1261, -1283, -1378, -1437, -1463, -1574, -1591, -1679, -1671, -1634, -1542, -1270, -990, -569, -180, 201, 548, 749, 908, 826, 645, 348, -38, -376, -749, -967, -1116, -1140, -1035, -925, -691, -482, -254, -81, 31, 171, 198, 271, 317, 349, 426, 439, 493, 490, 491, 499, 431, 381, 281, 190, 89, -25, -98, -188, -233, -265, -259, -218, -172, -89, -38, 26, 68, 65, 61, 20, -8, -42, -61, -49, -40, -2, 26, 45, 48, 0, -87, -207, -346, -526, -713, -882, -1026, -1120, -1182, -1185, -1132, -1022, -856, -671, -462, -254, -75, 54, 129, 153, 117, 43, -78, -206, -317, -420, -479, -519, -530, -521, -529, -517, -507, -499, -474, -432, -355, -244, -96, 81, 297, 528, 736, 915, 1044, 1129, 1150, 1101, 1016, 880, 718, 561, 421, 323, 271, 271, 318, 411, 530, 642, 756, 863, 944, 994, 1010, 1026, 1043, 1064, 1100, 1128, 1163, 1186, 1173, 1137, 1053, 931, 779, 592, 398, 218, 57, -82, -174, -229, -251, -230, -189, -137, -87, -45, -16, -5, -13, -49, -86, -141, -196, -239, -302, -359, -414, -505, -629, -777, -920, -1021, -1159, -1296, -1306, -1359, -1399, -1322, -1283, -1175, -1068, -1000, -871, -782, -615, -445, -392, -309, -267, -302, -359, -429, -506, -583, -639, -710, -758, -746, -717, -687, -662, -668, -643, -586, -541, -347, -137, 25, 301, 457, 620, 840, 908, 979, 926, 802, 708, 535, 450, 351, 227, 166, 77, 53, 36, 72, 179, 215, 294, 370, 419, 543, 626, 707, 802, 810, 831, 827, 785, 803, 706, 529, 362, 135, -23, -172, -318, -384, -450, -448, -422, -381, -281, -224, -169, -132, -114, -57, -12, 47, 98, 94, 98, 62, -32, -110, -233, -355, -447, -571, -613, -621, -607, -526, -495, -437, -367, -310, -208, -143, -63, 28, 104, 222, 315, 385, 466, 499, 521, 545, 543, 572, 560, 536, 542, 493, 490, 469, 443, 496, 509, 575, 664, 768, 920, 1011, 1117, 1182, 1216, 1267, 1288, 1312, 1340, 1376, 1369, 1356, 1346, 1300, 1234, 1133, 1061, 947, 859, 849, 812, 819, 821, 822, 783, 733, 751, 721, 748, 795, 867, 966, 1016, 1128, 1141, 1102, 1057, 906, 748, 589, 508, 407, 322, 311, 259, 250, 204, 197, 200, 157, 211, 218, 249, 325, 391, 458, 461, 495, 449, 366, 321, 228, 129, -35, -181, -318, -476, -576, -659, -672, -648, -550, -412, -334, -230, -218, -329, -541, -848, -1169, -1564, -1874, -2022, -2121, -2047, -1802, -1508, -1181, -841, -581, -450, -406, -443, -572, -787, -1007, -1182, -1384, -1537, -1583, -1632, -1673, -1661, -1658, -1692, -1668, -1636, -1668, -1629, -1550, -1415, -1146, -817, -407, -17, 321, 635, 771, 764, 621, 316, -92, -533, -921, -1260, -1431, -1426, -1341, -1135, -877, -578, -274, -11, 245, 435, 558, 654, 734, 784, 823, 828, 733, 623, 496, 351, 230, 113, 48, -10, -52, -39, -32, -5, 31, 58, 80, 126, 198, 239, 315, 385, 391, 383, 323, 249, 177, 86, 26, -37, -85, -93, -107, -111, -111, -144, -203, -265, -324, -397, -496, -588, -679, -775, -851, -925, -964, -933, -871, -762, -600, -405, -195, -30, 96, 171, 161, 104, -5, -150, -279, -397, -498, -556, -571, -567, -551, -526, -486, -431, -375, -282, -155, -21, 132, 288, 455, 629, 782, 916, 1016, 1088, 1133, 1132, 1084, 1002, 893, 747, 599, 475, 378, 335, 336, 395, 499, 616, 758, 895, 1019, 1128, 1203, 1247, 1271, 1296, 1288, 1261, 1233, 1170, 1094, 994, 875, 755, 621, 480, 329, 187, 60, -59, -180, -285, -340, -382, -393, -362, -311, -242, -181, -127, -95, -92, -136, -223, -307, -419, -525, -615, -717, -800, -880, -952, -1014, -1057, -1111, -1172, -1189, -1254, -1352, -1421, -1463, -1480, -1517, -1476, -1380, -1259, -1009, -761, -558, -339, -215, -207, -232, -302, -386, -451, -563, -633, -612, -572, -496, -452, -494, -552, -617, -750, -847, -799, -716, -526, -227, 49, 420, 806, 1112, 1348, 1379, 1288, 1116, 857, 650, 442, 221, 76, -27, -69, -39, 38, 108, 118, 116, 97, 88, 120, 169, 301, 433, 543, 708, 823, 928, 1010, 927, 748, 495, 193, -85, -360, -563, -673, -755, -765, -713, -614, -456, -345, -294, -268, -258, -225, -181, -125, -79, -26, 61, 98, 127, 150, 98, 48, -41, -192, -309, -406, -463, -494, -535, -511, -451, -357, -228, -120, 26, 165, 285, 410, 484, 580, 664, 712, 779, 826, 885, 946, 967, 960, 916, 840, 738, 627, 523, 441, 393, 416, 509, 665, 868, 1018, 1179, 1327, 1390, 1447, 1438, 1418, 1397, 1350, 1335, 1304, 1311, 1306, 1259, 1190, 1056, 944, 829, 725, 653, 591, 562, 534, 562, 561, 552, 592, 575, 585, 598, 634, 716, 804, 905, 913, 931, 907, 801, 735, 605, 480, 357, 238, 167, 89, 83, 76, 85, 94, 108, 191, 214, 318, 418, 452, 530, 537, 600, 634, 640, 709, 696, 697, 671, 650, 576, 411, 313, 104, -85, -246, -432, -442, -475, -431, -302, -225, -57, 103, 179, 140, 46, -144, -485, -787, -1141, -1502, -1754, -1916, -1948, -1848, -1562, -1279, -996, -689, -542, -461, -534, -694, -916, -1275, -1522, -1756, -1919, -1934, -1922, -1834, -1794, -1728, -1704, -1788, -1777, -1827, -1884, -1881, -1838, -1631, -1366, -1024, -653, -377, -139, 1, 41, -11, -187, -452, -783, -1083, -1303, -1467, -1517, -1438, -1293, -1078, -820, -544, -231, 32, 243, 385, 439, 498, 505, 506, 537, 512, 485, 442, 412, 416, 391, 380, 360, 313, 302, 323, 359, 410, 471, 520, 554, 617, 693, 732, 765, 800, 806, 804, 772, 716, 666, 590, 504, 387, 280, 228, 176, 147, 134, 122, 121, 90, 54, 5, -96, -226, -371, -505, -611, -696, -752, -757, -720, -644, -534, -404, -258, -148, -90, -68, -79, -123, -231, -366, -490, -610, -700, -759, -771, -742, -699, -645, -594, -524, -446, -398, -337, -250, -165, -60, 79, 235, 414, 591, 727, 835, 930, 976, 944, 883, 785, 645, 517, 392, 314, 295, 315, 398, 518, 702, 920, 1107, 1290, 1442, 1544, 1591, 1593, 1571, 1504, 1426, 1345, 1263, 1194, 1114, 1040, 961, 864, 757, 628, 494, 374, 263, 151, 62, 4, -29, -24, -13, 2, 34, 45, 30, -1, -50, -128, -245, -384, -521, -649, -773, -884, -971, -1035, -1088, -1134, -1164, -1174, -1190, -1229, -1253, -1282, -1327, -1354, -1371, -1361, -1353, -1347, -1300, -1255, -1169, -1058, -987, -905, -837, -816, -840, -914, -1005, -1100, -1201, -1296, -1291, -1186, -1053, -819, -573, -405, -223, -130, -161, -173, -213, -265, -225, -151, -18, 196, 402, 565, 639, 614, 520, 364, 178, 29, -40, -60, 33, 221, 395, 626, 845, 980, 1072, 1047, 971, 883, 730, 618, 537, 437, 404, 407, 401, 436, 451, 415, 357, 262, 136, -14, -140, -239, -287, -259, -228, -124, 1, 96, 215, 211, 160, 99, -47, -171, -302, -383, -397, -421, -401, -387, -368, -350, -378, -415, -459, -477, -467, -434, -365, -278, -184, -97, -35, -15, 6, 25, 40, 67, 73, 111, 146, 188, 242, 242, 270, 280, 278, 304, 316, 376, 415, 468, 537, 568, 650, 720, 807, 918, 1012, 1110, 1172, 1238, 1265, 1257, 1220, 1149, 1108, 1043, 1032, 1052, 1070, 1147, 1181, 1201, 1197, 1171, 1132, 1061, 1022, 944, 928, 939, 917, 974, 998, 1041, 1054, 1016, 1032, 986, 959, 944, 895, 852, 802, 766, 672, 631, 578, 481, 444, 354, 324, 289, 261, 320, 310, 359, 411, 446, 521, 564, 615, 603, 636, 616, 525, 519, 429, 391, 324, 217, 217, 112, 93, 77, -4, 37, 32, 37, 73, 152, 231, 248, 320, 318, 297, 257, 133, 38, -86, -166, -232, -294, -319, -361, -405, -560, -718, -927, -1234, -1507, -1850, -2047, -2134, -2155, -1920, -1667, -1315, -887, -550, -243, -78, -20, -125, -354, -670, -1099, -1404]
voiced_frame_fs = 48000
unvoiced_frame = [315, 483, 609, 310, 369, 604, 549, 496, 314, 381, 111, -64, 150, -83, -33, 63, 153, 314, 149, 250, 203, 67, -9, -221, -69, 39, 97, 118, 12, 32, -231, -258, -45, -209, -155, -120, -302, -143, -45, 44, 150, -76, 163, 380, 50, 77, 82, 245, 652, 426, 27, -178, -146, -210, -537, -468, -181, 184, 560, 678, 602, 404, 138, -246, -498, -745, -807, -474, -201, 245, 434, 428, 483, 133, 38, -79, -219, -266, -528, -272, -224, -289, 16, 216, 455, 290, 440, 580, 57, -22, -223, -333, -158, -182, 152, 206, -141, -336, -454, -653, -789, -559, -279, -125, -146, 7, -61, -529, -312, -244, -270, -35, -123, 249, 340, 161, 165, -137, -100, -296, -375, 119, 124, -38, 90, 396, 354, 196, 187, 27, 93, 49, 266, 629, 449, 308, 83, 175, 198, -247, -157, -70, -192, -194, 39, 241, 196, 333, 118, 36, -75, -530, -299, -309, -249, 128, -47, -33, 7, -57, -148, -265, -385, -533, -264, -304, -287, 12, 162, 543, 242, 21, 87, -306, -286, -489, -337, 247, 36, 76, 216, -92, -409, -578, -408, -223, -167, 31, 261, 348, 680, 694, 456, 835, 548, 40, 3, -345, -229, 32, 259, 325, 13, 278, 283, -191, -475, -613, -757, -891, -420, -195, -154, 172, 257, 545, 477, 372, 339, -41, 224, 228, -27, 140, 191, 296, 196, 191, 361, 362, 419, 302, 74, 8, 94, -34, -87, -27, -65, 265, 156, 109, 401, 57, 22, 35, -74, 13, -17, 25, -233, -55, 188, -121, 41, 317, 567, 494, 185, 39, -213, -234, -635, -721, -80, 143, 311, 353, 499, 487, 11, -138, -470, -666, -496, -398, -230, 147, 697, 586, 413, 373, 160, 282, -251, -661, -620, -837, -552, -549, -396, 41, -151, 30, 178, -74, -250, -401, -363, -290, -199, -192, -44, 233, 327, 474, 380, 323, 352, 131, 77, 33, 77, 27, -179, -11, 178, 318, 267, 209, 506, 452, 334, 193, -251, -225, -105, -276, -202, 56, 334, 626, 767, 698, 445, 39, -66, -104, -537, -423, -121, -314, -82, 103, -80, -106, -196, -261, -376, -366, -278, -392, -206, -111, -264, -370, -422, -211, -236, -121, 182, -6, 219, 473, 161, 136, 95, -88, -74, -180, -213, 61, 133, 116, 191, 9, -32, -64, -297, -261, -206, -158, -91, 0, 57, -45, 67, -138, -311, -137, -280, -107, -85, -72, 249, -117, -76, 20, -394, -316, -419, -432, -216, -179, 20, 43, 16, -70, -109, -32, -171, -106, -74, -16, 232, 219, 109, -57, 18, 51, -175, 78, 375, 392, 343, 237, 208, 117, -39, -191, -86, 162, 268, 363, 372, 579, 594, 266, 285, 81, -170, -83, -188, -285, -311, -100, 51, -236, -140, 108, 51, 48, -51, -70, 78, 18, -113, -207, -140, 118, 73, -61, -9, -26, 151, 352, 272, 229, 173, -3, -199, -379, -416, -276, -172, -18, 264, 321, 364, 409, 264, 198, 9, -70, -81, -294, -190, -199, -278, -74, -54, 142, 354, 300, 324, 183, 15, -57, -203, -183, -71, 5, 197, 275, 214, 269, 159, 33, 13, -286, -362, -179, -165, 15, 156, 34, -43, -115, -209, -86, 134, 97, 40, 162, 133, 103, 211, -25, -319, -289, -404, -361, -96, -164, -108, 90, 142, 125, -70, -71, 3, -200, -233, -130, -138, -66, 55, 209, 344, 268, 290, 390, 334, 298, 46, -196, -268, -355, -124, 55, 191, 377, 363, 689, 748, 406, 392, 265, 25, -295, -469, -310, -441, -461, -69, 243, 395, 450, 446, 321, 15, -320, -486, -592, -553, -344, -342, -162, 228, 387, 439, 419, 387, 95, -242, -319, -562, -545, -280, -180, -50, 68, 294, 318, 120, 109, 25, -16, -47, -124, 24, 103, 23, -88, -193, -141, -34, -67, -22, 163, 144, 33, -39, -139, -204, -259, -205, -45, 88, 40, 56, 269, 101, -13, 69, -194, -269, -258, -405, -373, -251, -173, -122, 30, -10, -111, -94, -278, -204, -60, -113, -81, -130, -62, 4, 22, 98, 65, 99, 125, 151, 76, 12, 63, -74, 29, 74, -63, 54, 95, 242, 319, 291, 304, 133, 149, 18, -244, -219, -149, -66, -72, 0, 87, 104, 182, 174, 157, 75, 131, 81, -73, 79, -71, -98, 57, 35, 226, 192, 233, 256, 87, 92, -263, -439, -440, -575, -381, -296, -191, 10, 169, 315, 157, 78, 151, 38, -188, -268, -190, -12, 188, 76, 92, 256, 230, 327, 324, 211, 24, -104, -86, -224, -114, 23, 55, 239, 227, 168, 84, 66, 133, 48, -68, -260, -312, -240, -82, 46, -74, 133, 300, 112, 101, 113, 75, 31, 9, -7, -52, -10, 44, 53, -2, 4, -60, -209, -135, -114, -201, -199, -213, -251, -155, -29, -20, 110, 13, -168, -35, -146, -211, -117, -165, -116, 32, 259, 239, 122, 77, -143, -157, -134, -161, 9, 139, 199, 205, 204, 115, -39, -58, -20, -126, -247, -11, 22, -171, -25, 2, 27, 108, 122, 203, 72, 109, 214, 121, 145, 58, 0, 53, -33, -93, 3, 147, 178, 257, 343, 215, 65, 1, -73, -172, -178, -111, 10, 142, 162, 204, 163, 71, 73, -101, -229, -87, -47, -114, -46, -4, -22, 68, 154, 204, 178, 43, 5, 71, 35, -95, -70, -43, -133, -122, -115, -46, -4, -102, -31, 29, -11, 1, 45, 75, -41, -145, -149, -148, -98, 30, 157, 166, 188, 199, 90, -24, -211, -410, -425, -307, -271, -201, 69, 153, 84, 116, 20, -125, -137, -31, 109, 108, 57, 88, 98, 79, 133, 180, 143, 134, 98, -1, 17, -24, -188, -261, -314, -240, -98, -49, 28, 82, 220, 266, 118, 40, -108, -231, -372, -448, -292, -211, -17, 152, 236, 286, 130, 197, 138, -65, -147, -369, -324, -263, -176, 86, 124, 233, 234, 104, 21, -128, -192, -245, -278, -400, -305, -39, 30, 262, 253, 224, 342, 154, 211, 201, 117, 195, 94, 134, 64, -11, 79, 10, 32, -9, -46, 48, -1, -23, 18, -22, -46, 4, 47, 165, 200, 208, 377, 264, 157, 117, -115, -77, -95, -93, 112, 134, 249, 325, 219, 59, -87, -64, -106, -147, -83, -11, 93, 166, 220, 180, 120, 46, -81, -76, -54, -24, -23, -147, -145, -53, -26, 77, 232, 303, 286, 107, -90, -120, -113, -59, -45, -25, 53, -29, 5, 33, -140, -206, -300, -313, -317, -447, -337, -295, -349, -205, -92, 40, 126, 109, 132, 33, -90, -145, -211, -150, -34, -25, -62, -52, -31, -46, -34, -72, -101, -21, -34, -132, -105, -4, -7, -31, -17, 3, 147, 200, 108, 59, -29, -59, -95, -139, -76, -39, 29, 38, 25, 145, 206, 142, 26, 4, 27, 10, 28, 66, 142, 163, 136, 35, -85, -62, -85, -77, -75, -117, -54, -39, 41, 57, 49, 141, 98, 115, 32, -66, 4, -55, -32, -6, 22, 109, 82, 95, 38, -9, -67, -215, -245, -267, -200, -90, 7, 122, 146, 180, 107, -4, -37, -49, -69, -188, -148, -53, -51, 25, 58, 128, 147, 58, -30, -159, -175, -171, -201, -146, -90, -36, 36, 89, 99, 124, 152, 124, 58, -12, -48, -104, -158, -201, -156, -12, 54, 158, 196, 158, 159, 28, -43, -77, -144, -138, -120, -22, 6, 18, 47, 28, 133, 128, 42, 42, 5, -29, -26, 38, 86, 141, 157, 99, 129, 85, 38, 59, 37, 39, 20, 53, 67, 2, -58, -112, -106, -152, -159, -55, 46, 140, 202, 256, 190, 98, 48, -54, -71, -93, -61, 8, 28, 139, 140, 137, 179, 86, 14, -32, -52, -64, -70, -50, -22, 33, 24, 94, 198, 200, 154, 43, -3, -89, -187, -171, -153, -65, -15, 17, 17, -11, 82, 40, -8, -8, -68, 0, -22, -29, 64, 34, 25, 22, 17, 40, 1, -48, -45, -14, -18, -53, -52, 40, 76, 60, 133, 79, 21, 52, 0, -12, -59, -56, 42, 23, 55, 107, 98, 99, 85, 79, -5, -85, -120, -154, -60, 22, 89, 180, 161, 158, 130, 44, 2, -76, -114, -87, -58, 16, 65, 95, 133, 101, 21, -54, -101, -90, -78, -107, -100, -93, -107, -33, 26, 33, 51, 43, 57, 16, -24, 19, -30, -71, -75, -114, -85, -85, -85, -12, 44, 64, 21, 19, 20, -119, -212, -201, -175, -109, -42, 10, 41, 15, -8, -34, -118, -125, -76, -110, -106, -63, -46, 8, 22, 0, -16, -55, -39, -35, -57, 19, 84, 67, 4, -67, -81, -94, -116, -148, -121, 26, 77, 62, 86, 87, 86, 4, -59, -96, -181, -137, -89, -52, 51, 69, 70, 48, -30, -89, -134, -156, -91, 37, 53, 63, 123, 118, 127, 99, 103, 157, 182, 221, 169, 160, 159, 73, 33, -58, -78, -98, -117, 1, -27, -27, 38, 26, 65, -2, -49, -42, -67, -41, -72, -69, -29, 50, 155, 148, 138, 46, -17, -25, -119, -89, -71, -34, 62, 49, 122, 120, 56, 62, -13, 4, 7, -38, -15, -53, -48, -24, -11, 30, 73, 131, 107, 70, 14, -72, -105, -144, -96, -43, -21, 52, 61, 85, 82, 49, 70, 49, 33, -16, -82, -125, -162, -111, -57, 37, 132, 128, 123, 68, 9, -12, -31, -51, -57, 17, 53, 98, 170, 137, 102, 10, -93, -117, -144, -134, -105, -25, 44, 53, 81, 71, 69, 49, -1, -33, -66, 7, 60, 49, 109, 132, 112, 80, 28, -17, -58, -83, -106, -102, -57, -8, 10, 5, 20, 2, -29, -63, -123, -104, 6, 84, 97, 151, 198, 151, 99, 30, -51, -73, -49, -36, -94, -120, -65, -9, 60, 103, 102, 112, 95, -6, -118, -169, -207, -217, -179, -112, 5, 106, 158, 167, 118, 69, -12, -92, -64, -24, 26, 103, 95, 79, 67, 38, 35, 18, 36, 34, -20, -44, -109, -171, -191, -169, -78, -23, 24, 92, 119, 104, 65, 60, 53, 11, -6, -2, -6, -4, 26, 48, 67, 107, 121, 84, 18, -34, -78, -113, -149, -173, -161, -150, -78, 12, 72, 143, 114, 84, 73, 1, -37, -130, -212, -199, -152, -28, 70, 112, 145, 144, 117, 41, -55, -126, -129, -115, -139, -142, -112, -49, -6, 22, 63, 51, 38, 21, -3, -37, -92, -68, -70, -84, -18, 3, 18, 30, 19, 41, 5, -71, -121, -173, -190, -176, -145, -73, -6, 28, 58, 84, 79, 33, 6, -11, -65, -48, 5, 28, 73, 76, 80, 106, 79, 75, 63, 20, 22, 1, -30, -23, -27, -10, 30, 48, 36, 37, 109, 162, 152, 137, 83, 17, -32, -59, -64, -67, -14, 53, 102, 149, 135, 89, 11, -88, -128, -136, -135, -87, -13, 22, 50, 58, 13, -26, -75, -95, -91, -106, -74, -48, -13, 23, -2, 1, 26, 65, 81, 58, 58, 23, -8, -28, -59, -49, -34, -4, 24, 33, 45, 33, 2, -46, -76, -92, -94, -72, -69, -7, 52, 53, 95, 105, 70, 36, -7, -59, -105, -84, -51, -46, -28, 17, 61, 53, 50, 25, -33, -50, -80, -85, -60, -54, -3, 76, 128, 120, 111, 113, 66, 30, -38, -103, -79, -79, -69, -20, 18, 57, 82, 104, 89, 47, 23, -14, -42, -43, -24, 4, 65, 136, 135, 118, 96, 48, 25, 22, 31, 26, 46, 61, 30, 41, 33, 25, 62, 47, 22, -6, -19, 3, 2, 12, -1, -30, -13, 7, -11, -44, -26, -2, -1, 3, 19, 76, 88, 72, 80, 50, 14, -25, -50, -54, -79, -88, -95, -101, -81, -54, -22, 1, -7, -32, -28, -45, -103, -100, -55, -18, 25, 71, 101, 106, 102, 72, 59, 61, 32, 29, 24, 22, 22, -25, -45, -67, -66, -15, -25, -28, -8, -21, -43, -71, -70, -89, -95, -54, -55, -26]
unvoiced_frame_fs = 48000
noise_frame = [-1, -1, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 0, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, -1, -1, -1, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, -1, 0, 0, -1, -1, -1, 0, -1, -2, -1, 0, -1, 0, -1, -1, 0, -1, 0, -1, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 2, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, 0, -1, -1, 0, -1, -2, -1, -2, -2, -2, -2, -2, -2, -2, -1, -2, -2, -2, -1, -1, -2, -2, -2, -2, -2, -2, -1, -2, -1, -1, -2, 0, -3, -2, -2, -2, -1, -2, -1, -1, -1, -1, -1, -2, -2, -1, -2, -2, -2, -2, -2, -2, -1, -2, -2, -2, -2, -2, -2, -1, -3, -2, -1, -2, -1, -2, -1, -2, -3, -2, -3, -2, -2, -2, -2, -2, -2, -2, -1, -2, -2, -2, -2, -2, -1, -1, -2, -2, -1, -1, -2, -2, -2, -1, -2, -1, -2, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -2, -1, -2, -3, -1, -2, -2, -2, -1, -2, -2, -2, -3, -2, -1, -2, -2, -2, -2, -2, -1, -1, -2, -1, -1, -2, -1, 0, -2, -2, -1, 0, -2, -1, -1, -2, 0, -2, -1, 0, -1, -1, 0, -1, -1, -1, -1, -1, -2, -1, -1, -1, -1, 0, -1, -1, -3, -1, -1, -1, 0, -1, -1, 0, -1, -1, 0, -1, -1, -1, -1, 0, 0, -1, -1, 0, 0, -1, 0, 0, -1, -1, -1, -1, -1, 0, 0, -1, 0, 0, -1, -1, 0, -1, -2, -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, -1, -1, -2, -2, -1, -1, -1, 0, -2, -1, -1, -1, -1, -2, -1, -2, -2, -1, -2, -1, -1, -3, -2, -2, -2, -2, -2, -2, -2, -3, -3, -2, -2, -3, -2, -3, -3, -2, -3, -3, -3, -3, -3, -3, -2, -4, -3, -3, -4, -3, -3, -3, -3, -3, -3, -4, -3, -3, -4, -3, -4, -4, -4, -4, -3, -4, -3, -3, -4, -3, -4, -3, -3, -3, -3, -2, -3, -4, -2, -3, -2, -3, -3, -2, -2, -1, -3, -3, -2, -2, -2, -3, -2, -2, -2, -1, -1, -1, -2, -2, -2, -1, -2, -2, -1, -1, -1, -2, -1, -1, -2, -2, -1, -1, -1, -1, -1, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, 0, -1, 0, 0, 0, -2, 0, 0, -1, 0, -1, 0, -1, 0, 0, -2, 0, 0, -1, 0, -1, 0, 0, 0, -1, -1, -1, -1, -1, 0, -1, -2, 0, 0, -1, -2, -1, -1, -2, -1, -2, -1, 0, -1, 0, -1, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, -1, -1, 0, -1, 0, -1, 0, -1, -1, 0, -1, 0, -1, 0, 0, -1, 0, -1, 0, 0, 0, -1, -1, 0, 0, -1, 0, 0, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, 0, -1, -1, 0, -1, -1, -1, -2, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -2, -1, -2, -1, -1, -1, -1, -1, -1, -2, -1, -1, -1, -1, -1, -2, -2, -1, -2, -2, -1, -2, -2, -2, -1, -2, -1, -1, -2, -1, -2, -1, -2, -2, -1, -2, -1, -1, -1, -2, -2, -2, -3, -1, -1, -1, -1, -2, -1, -2, -2, -2, -2, -1, -1, -3, -2, -2, -1, -2, -2, -1, -2, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, -2, -1, -2, -1, -1, -1, 0, -2, -1, -1, 0, -1, -1, 0, -1, -1, 0, -2, -1, -1, -1, 0, -1, 0, -1, -1, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, -1, 0, -1, 0, 0, -1, 0, -1, -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, -1, 0, 0, 0, -1, 0, -1, 0, -1, -1, 0, -1, 0, -1, -1, 0, -2, -1, -2, -1, -1, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -2, -1, -2, -1, -1, -1, -1, -1, -2, 0, -1, -1, 0, -1, -1, -1, -1, -2, 0, -1, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, -1, 0, 0, -1, 0, -1, 0, -1, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -2, -1, -2, -2, -2, -2, -2, -3, -2, -2, -1, -2, -1, -1, -3, -2, -1, -2, -2, -2, -2, -1, -2, -1, -1, -2, 0, -2, -2, -1, -1, -2, -1, -2, -2, -2, -2, -2, -2, -2, -3, -2, -2, -1, -1, -1, -2, -2, -2, -2, -2, -2, -2, -2, -2, -1, -2, -1, -2, -2, -2, -2, -2, -1, -2, -2, -2, -1, -3, -2, -2, -1, -2, -2, -2, -2, -2, 0, -2, -2, -2, -2, -2, -2, -1, -2, -2, -1, -2, -2, -2, -2, -2, -2, -1, -1, -3, -1, -1, -3, -1, -2, -2, -1, 0, -2, -2, -1, -1, -1, -2, -1, -1, -1, -2, -1, -1, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, -1, -1, 0, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, 0, -1, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, -2, 0, -1, -1, -1, -1, -1, -1, -2, -1, -1, -1, -1, 0, -1, -2, -1, -2, -2, -2, -1, -1, -1, -2, -2, -1, -1, -1, -1, 0, 0, -1, 0, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, 0, 0, -2, -1, 0, -1, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, 0, 0, -1, 0, -1, 0, 0, -1, 0, -1, 0, -1, -1, 0, 0, -1, 0, 0, 0, -2, 0, 0, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, -1, -1, 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -2, -1, -2, -2, -2, -2, -1, -1, -1, -2, -1, -3, -2, -1, -3, -2, -1, -2, -2, -2, -2, -2, -3, -1, -2, -3, -1, -3, -2, -2, -2, -3, -3, -2, -3, -1, -2, -2, -2, -3, -2, -3, -3, -2, -3, -3, -2, -3, -3, -3, -3, -3, -3, -2, -3, -2, -3, -3, -3, -2, -1, -2, -2, -2, -2, -3, -3, -2, -2, -2, -1, -2, -1, -3, -2, -2, -2, -2, -3, -1, -2, -2, -3, -2, -1, -1, -1, -2, -2, -1, -1, -2, -2, -1, 0, -1, -2, -1, -1, -1, -2, -1, -1, -1, -1, 0, 0, -1, -2, -1, -1, -1, -1, -1, -1, 0, -1, -2, 0, -2, 0, 0, -1, 0, -2, -1, -1, -1, 0, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, 0, -1, 0, 0, -1, 0, -1, 0, 1, 0, -1, -1, -2, -1, -2, -2, -2, -2, -2, -2, -1, -1, -2, 0] 
noise_frame_fs = 48000

def test_speed_voiced_frame():
    assert calculate_frame_duration(voiced_frame,voiced_frame_fs) == 0.04
    
def test_speed_unvoiced_frame():
    assert calculate_frame_duration(unvoiced_frame,unvoiced_frame_fs) == 0.04
    
def test_speed_noise_frame():
    assert calculate_frame_duration(noise_frame,noise_frame_fs) == 0.04
    
def test_speed_empty_frame():
    assert calculate_frame_duration([],48000) == 0
    
def test_pitch_voiced():
    assert calculate_frame_pitch(voiced_frame,voiced_frame_fs) == pytest.approx(115.64, 0.01)
    
def test_pitch_unvoiced():
    assert math.isnan(calculate_frame_pitch(unvoiced_frame,unvoiced_frame_fs))
    
def test_pitch_noise():
    assert math.isnan(calculate_frame_pitch(noise_frame,noise_frame_fs))
    
def test_pitch_empty_frame():
    assert math.isnan(calculate_frame_pitch([],48000))
    
def test_formants_voiced_frame():
    formants = calculate_frame_f1_f2(voiced_frame,voiced_frame_fs)
    assert len(formants)==2
    assert formants[0] == pytest.approx(474.43, 0.01)
    assert formants[1] == pytest.approx(1924.64, 0.01)
    
def test_formants_unvoiced_frame():
    formants = calculate_frame_f1_f2(unvoiced_frame,unvoiced_frame_fs)
    assert len(formants)==2
    assert formants[0] == pytest.approx(1495.43, 0.01)
    assert formants[1] == pytest.approx(2157.37, 0.01)
    
def test_formants_noise_frame():
    formants = calculate_frame_f1_f2(noise_frame,noise_frame_fs)
    assert len(formants)==2
    assert formants[0] == pytest.approx(192.72, 0.01)
    assert formants[1] == pytest.approx(1864.27, 0.01)
    
def test_formants_empty_frame():
    formants = calculate_frame_f1_f2([],0)
    assert len(formants)==2
    assert math.isnan(formants[0])
    assert math.isnan(formants[0])